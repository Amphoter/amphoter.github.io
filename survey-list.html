<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Опитування — Yuppa Flow</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <div id="header"></div>

  <main class="container">
    <h1>Доступні опитування</h1>
    <div id="surveyList" class="survey-list"></div>
    <div id="loading" class="center">Завантаження...</div>
  </main>

  <div id="footer"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Load header and footer
      fetch('header.html')
        .then(r => r.text())
        .then(t => document.getElementById('header').innerHTML = t);

      fetch('footer.html')
        .then(r => r.text())
        .then(t => document.getElementById('footer').innerHTML = t);

      // Load surveys
      async function loadSurveys() {
        const list = document.getElementById('surveyList');
        const loading = document.getElementById('loading');

        try {
          const response = await fetch('https://stressapi.onrender.com/api/public/questionarries', {
            headers: { accept: 'text/plain' }
          });
          const data = await response.json();
          const surveys = data.items || [];

          loading.style.display = 'none';

          if (surveys.length === 0) {
            list.innerHTML = '<div class="center">Немає доступних опитувань.</div>';
            return;
          }

          surveys.forEach(survey => {
  const link = document.createElement('a');
  link.href = `survey-details.html?id=${survey.id}`;
  link.style.textDecoration = 'none';
  link.style.color = 'inherit';

  const card = document.createElement('div');
  card.className = 'survey-card';
  card.style.cursor = 'pointer';

  const title = document.createElement('div');
  title.className = 'survey-title';
  title.textContent = survey.name || 'Без назви';

  //const description = document.createElement('div');
  //description.className = 'survey-description';
  //description.textContent = survey.description || 'Опис відсутній.';

  card.appendChild(title);
  //card.appendChild(description);
  link.appendChild(card);
  list.appendChild(link);
});
        } catch (error) {
          loading.textContent = 'Не вдалося завантажити опитування.';
          console.error('Survey fetch error:', error);
        }
      }

      loadSurveys();
    });
  </script>
</body>
</html>
